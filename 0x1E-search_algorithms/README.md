This is the implementation of the search algorithm
